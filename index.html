<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>EnergiaCorp Premium</title>
<!-- Include Tesseract.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
<style>
/* CSS Completo Responsive per Mobile */

:root {
  --space-xs: 4px;
  --space-sm: 8px;
  --space-md: 12px;
  --space-lg: 16px;
  --space-xl: 24px;

  --text-xs: 10px;
  --text-sm: 14px;
  --text-base: 16px;
  --text-lg: 20px;

  --primary: #2563eb;
  --success: #059669;
  --error: #dc2626;
  --accent: #f59e0b;
  --bg-primary: #f8fafc;
  --bg-secondary: #e2e8f0;
  --border-light: #cbd5e1;
  --shadow-md: 0 4px 8px rgba(0,0,0,0.1);
  --bg-gradient: linear-gradient(135deg, #0ea5e9, #06b6d4);
  --text-white: #fff;
  --text-primary: #1e293b;
  --text-secondary: #475569;
}

/* Header azzurro */
header {
  background: var(--bg-gradient);
  color: var(--text-white);
  padding: var(--space-md);
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
}

.header__brand {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  font-size: var(--text-lg);
  font-weight: 700;
}
.brand-icon { font-size: 28px; }
.header__nav {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  flex-wrap: wrap;
}
.header__actions {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  margin-top: var(--space-sm);
}
button, .nav-btn {
  background: transparent;
  border: none;
  color: var(--text-white);
  cursor: pointer;
  font-size: var(--text-sm);
  display: flex;
  align-items: center;
  gap: var(--space-xs);
}
button:hover, .nav-btn:hover {
  opacity: 0.8;
}
.theme-toggle {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: 1px solid rgba(255,255,255,0.3);
  background: rgba(255,255,255,0.1);
  font-size: 18px;
}
header .header__container {
  width: 100%;
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  align-items: center;
  gap: var(--space-md);
}

/* Main */
main {
  padding: var(--space-lg);
}
.section {
  max-width: 1200px;
  margin: 0 auto;
}
#section-offers {
  display: block;
}

/* Tabella Gestione offerte */
#offers-table {
  width: 100%;
  border-collapse: collapse;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: var(--shadow-md);
  background: var(--bg-primary);
  font-size: var(--text-sm);
}
#offers-table thead {
  background: var(--bg-gradient);
}
#offers-table th, #offers-table td {
  padding: var(--space-sm);
  border: 1px solid var(--border-light);
  text-align: left;
}
#offers-table th {
  font-weight: 600;
  font-size: var(--text-xs);
}
#offers-table td {
  font-size: var(--text-sm);
}
@media(max-width: 768px){
  #offers-table {
    font-size: var(--text-xs);
  }
}
.file-preview-container {
  margin-top: var(--space-lg);
  background: var(--bg-primary);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  overflow: hidden;
}
.preview-header {
  background: var(--bg-gradient);
  display:flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-md);
  font-weight: 600;
  font-size: var(--text-lg);
  color: var(--text-white);
}
.preview-body {
  display: grid;
  grid-template-columns: 1fr 2fr;
  gap: var(--space-md);
  padding: var(--space-md);
  background: #fff;
}
@media(max-width:768px){
  .preview-body {
    grid-template-columns: 1fr;
  }
}
.file-thumbnail {
  width: 100%;
  aspect-ratio: 1/1;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #f1f5f9;
  border: 1px solid #e2e8f0;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}
.pdf-thumb {
  background: linear-gradient(135deg, #dc2626, #ef4444);
  color: #fff;
  font-size: 28px;
}
#upload-area {
  border: 2px dashed #cbd5e1;
  border-radius: 12px;
  padding: 40px;
  text-align: center;
  cursor: pointer;
  background: #fff;
}
#upload-area.dragover {
  background: #eff6ff;
  border-color: #3b82f6;
}
#upload-area .upload-icon {
  font-size: 40px;
  color: #94a3b8;
  margin-bottom: 12px;
}
#file-preview-container {
  display:none;
}
#pagination-info {
  font-size: var(--text-sm);
  margin-right: var(--space-md);
}
</style>
</head>
<body>

<header>
  <div class="header__container">
    <div class="header__brand">
      <div class="brand-icon">‚ö°</div>
      <div class="brand-text">EnergiaCorp</div>
    </div>
    <nav class="header__nav">
      <button class="nav-btn" data-section="dashboard">üè† Dashboard</button>
      <button class="nav-btn" data-section="upload">üìÑ OCR</button>
      <button class="nav-btn" data-section="offers">üìã Gestione</button>
    </nav>
    <div class="header__actions">
      <button id="theme-toggle" title="Tema">üåì</button>
      <button id="user-name" style="max-width:80px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Utente</button>
      <button id="logout-btn">üö™ Logout</button>
    </div>
  </div>
</header>

<main>
  <!-- Sezione Upload -->
  <section id="section-upload" class="section">
    <div id="upload-area">üìÑ Trascina qui i PDF o clicca</div>
    <input type="file" id="pdf-file" accept="application/pdf,image/*" style="display:none"/>
    <div id="file-preview-container"></div>
    <!-- Form OCR (molto semplice) -->
    <form id="ocr-form" style="margin-top:24px; display:none;">
      <div><label>Fornitore:</label><input name="fornitore" type="text" /></div>
      <div><label>Nome Offerta:</label><input name="nome_offerta" type="text" /></div>
      <div style="margin-top:12px;"><button type="submit">Salva Offerta</button></div>
    </form>
  </section>

  <!-- Sezione Gestione Offerte -->
  <section id="section-offers" class="section" style="display:none;">
    <h2>üìã Gestione Offerte</h2>
    <table id="offers-table">
      <thead>
        <tr>
          <th class="col-fornitore">Fornitore</th>
          <th class="col-nome">Offerta</th>
          <th class="col-categoria">Categoria</th>
          <th class="col-tipo">Tipo</th>
          <th class="col-commodity">Commodity</th>
          <th class="col-valore">Prezzo/Spread</th>
          <th class="col-quota">Quota Fissa</th>
          <th class="col-scadenza">Scadenza</th>
          <th class="col-azioni">Azioni</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div style="margin-top:12px;">
      <span id="pagination-info">Mostrando 0 offerte</span>
    </div>
  </section>
</main>

<script>
/* **Script di base per l'interattivit√† (upload, OCR, tabella)**
Puoi incollare qui sotto il codice di app.js integrato, ottimizzato per mobile.
*/

/* ===================== INIZIO SCRIPT ===================== */
const uploadArea = document.getElementById('upload-area');
const fileInput = document.getElementById('pdf-file');
const previewContainer = document.getElementById('file-preview-container');
const formOCR = document.getElementById('ocr-form');
const sectionUpload = document.getElementById('section-upload');
const sectionOffers = document.getElementById('section-offers');

function showSection(name) {
  if (name === 'upload') {
    sectionUpload.style.display='block';
    sectionOffers.style.display='none';
  } else if (name==='offers') {
    sectionUpload.style.display='none';
    sectionOffers.style.display='block';
  }
}

// Gestione pulsante navigazione
document.querySelectorAll('.nav-btn').forEach(b => {
  b.onclick = () => {
    showSection(b.dataset.section);
    if (b.dataset.section==='offers') { renderOffersTable(); }
  }
});

// Upload tramite drag and drop o clic
uploadArea.addEventListener('click', ()=>fileInput.click());
fileInput.addEventListener('change', ()=> {
  const file = fileInput.files[0]; if (file) handleFile(file);
});
uploadArea.addEventListener('dragover', e => {
  e.preventDefault(); uploadArea.classList.add('dragover');
});
uploadArea.addEventListener('dragleave', ()=> uploadArea.classList.remove('dragover'));
uploadArea.addEventListener('drop', e => {
  e.preventDefault(); uploadArea.classList.remove('dragover');
  const file = e.dataTransfer.files[0]; if (file) handleFile(file);
});

// Gestione anteprima e OCR
async function handleFile(file) {
  showPreview(file);
  // Esegui OCR, qui puoi richiamare le funzioni di OCR
  alert('Anteprima caricata. Ora puoi integrare OCR.');
  // Per ora, mostra solo anteprima
}

// funzione generica per anteprima
function showPreview(file) {
  previewContainer.innerHTML='';
  previewContainer.style.display='block';
  const reader = new FileReader();
  reader.onload = ()=> {
    previewContainer.innerHTML = `
      <div style="display:flex; align-items:center; justify-content:space-between; padding:8px; background:#3b82f6; color:#fff; border-radius:8px;">
        <div>Anteprima: ${file.name}</div>
        <button style="background:rgba(255,255,255,0.3); border:none; border-radius:4px; padding:4px 8px; cursor:pointer;">Rimuovi</button>
      </div>
      <div style="margin-top:8px; background:#fff; padding:8px; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.1);">
        <img src="${reader.result}" style="max-width:100%; height:auto; border-radius:8px;" />
      </div>
    `;
    previewContainer.querySelector('button').onclick= ()=> { previewContainer.innerHTML=''; previewContainer.style.display='none'; };
  };
  reader.readAsDataURL(file);
}

// *** Inserisci qui le funzioni di OCR, salvataggio, tabella.. da aggiungere ulteriormente ***

</script>

</body>
</html>
